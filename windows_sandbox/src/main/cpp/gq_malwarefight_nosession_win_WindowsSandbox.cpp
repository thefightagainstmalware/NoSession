#include <jni.h>

#include <windows.h>
#include "gq_malwarefight_nosession_win_WindowsSandbox.h"
#include "ContainerCreate.h"

// why? JNI_TRUE and JNI_FALSE are not actually jbooleans, they are ints
jboolean jni_true = 1;
jboolean jni_false = 0;
#define BOOL_TO_JNI(x) (x) ? jni_true : jni_false

#ifdef __cplusplus
extern "C" {
#endif


/*
 * Class:     gq_malwarefight_nosession_win_WindowsSandbox
 * Method:    runSandboxed
 * Signature: ([Ljava/lang/String;[Ljava/lang/String;)Z
 */
JNIEXPORT jboolean JNICALL Java_gq_malwarefight_nosession_win_WindowsSandbox_runSandboxed
        (JNIEnv * /*env*/, jclass, jobjectArray /*rwMounts*/, jobjectArray /*roMounts*/, jobjectArray /*args*/) {
    return BOOL_TO_JNI(false);
}

JNIEXPORT jboolean JNICALL Java_gq_malwarefight_nosession_win_WindowsSandbox_isSandboxed
        (JNIEnv*, jclass) {
    return BOOL_TO_JNI(IsInAppContainer());
}

#ifdef __cplusplus
}
#endif
